<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Qu√£o facil √© criar um plugin para NativeScript | DZF Web</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><!-- gallery that comes before the header--><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a href="/" class="sidebar-nav-item active">Inicio</a><a href="/contato" class="sidebar-nav-item">Contato</a><a href="/sobre" class="sidebar-nav-item">Sobre</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/angular2/">angular2</a><a class="post-tag-link" href="/tags/javascript/">javascript</a><a class="post-tag-link" href="/tags/nativescript/">nativescript</a><a class="post-tag-link" href="/tags/plugin/">plugin</a></div><div class="post-time">25-05-2017</div></div></div><div class="container post-header"><h1>Qu√£o facil √© criar um plugin para NativeScript</h1></div><div class="container post-content"><p>√â not√≥rio a crescente quantidade de plugins dispon√≠veis para NativeScript desenvolvidos pela comunidade, e o motivo disso n√£o √© apenas a boa vontade e senso de contribui√ß√£o por parte de quem desenvolve, e sim, inclusive, a <strong>facilidade que √© desenvolver um plugin para NativeScript</strong>, principalmente depois da vers√£o 3.0.</p>
<p>Neste artigo, irei demonstrar como desenvolvi o <strong><a href="https://github.com/dzfweb/nativescript-emoji" target="_blank" rel="external">NativeScript Emoji</a></strong>, meu primeiro  UI Plugin para NativeScript. Ao termino da leitura deste artigo, espero despertar em voc√™ o interesse em desenvolver tamb√©m um plugin e contribuir para a comunidade de desenvolvedores NativeScript, quem ganha com isso somos n√≥s mesmos.</p>
<a id="more"></a>
<h2 id="Por-onde-comecar"><a href="#Por-onde-comecar" class="headerlink" title="Por onde come√ßar?"></a>Por onde come√ßar?</h2><p>N√£o vou entrar em detalhes sobre toda a estrutura necessaria para desenvolver um plugin para NativeScript pois isso n√£o vai ser necess√°rio para este artigo. Vou demonstrar o basico que voc√™ precisa saber para come√ßar, mas caso prefira, a documenta√ß√£o completa voc√™ pode acessar <a href="https://docs.nativescript.org/plugins/plugins" target="_blank" rel="external">clicando aqui</a>.</p>
<p>A maneira mais facil de come√ßar um plugin para NativeScript, √© utilizando o  <strong><a href="https://github.com/NathanWalker/nativescript-plugin-seed" target="_blank" rel="external">NativeScript Plugin Seed</a></strong>, criado por NathanWalker. Esta biblioteca far√° todo o trabalho √°rduo de cria√ß√£o da estrutura de um plugin NativeScript, e isso √© realmente incr√≠vel. Veja como √© facil:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/NathanWalker/nativescript-plugin-seed.git myplugin</div><div class="line">cd myplugin</div><div class="line">npm run postclone</div><div class="line">npm run setup</div></pre></td></tr></table></figure>
<p>Pronto, com apenas estas etapas voc√™ ter√° criado toda estrutura necess√°ria para desenvolver, testar e publicar seu plugin, mas antes de por a m√£o na massa, vamos fazer uma breve introdu√ß√£o sobre o plugin que vamos desenvolver juntos neste artigo.</p>
<h2 id="O-plugin-NativeScript-Emoji"><a href="#O-plugin-NativeScript-Emoji" class="headerlink" title="O plugin NativeScript Emoji"></a>O plugin NativeScript Emoji</h2><p>O objetivo deste plugin √© entregar um elemento para a interface para exibir Emojis de forma amigavel. A minha ideia inicial era ter um elemento TextView onde ao definir o valor unicode ou hexadecimal do emoji na propriedade correspondente:</p>
<p><code>&lt;Emoji:Emoji icon=&quot;128514&quot;&gt;</code> <em>exibir</em> :üòÇ </p>
<p>O plugin faria a convers√£o para Emoji, e aqui eu deixo um destaque novamente para a comunidade NativeScript no Slack (se voc√™ ainda n√£o participa, fa√ßa sua inscri√ß√£o agora (<a href="http://developer.telerik.com/wp-login.php?action=slack-invitation" target="_blank" rel="external">clicando aqui</a>), que me fizeram uma excelente sugest√£o de substituir a propriedade unicode por um valor amigavel e mais facil de lembrar, ficando ent√£o:</p>
<p><code>&lt;Emoji:Emoji name=&quot;joy&quot;&gt;</code> <em>exibir</em> :üòÇ </p>
<h2 id="Implementacao-para-Android-e-iOS"><a href="#Implementacao-para-Android-e-iOS" class="headerlink" title="Implementa√ß√£o para Android e iOS"></a>Implementa√ß√£o para Android e iOS</h2><p>Agora que j√° temos a defini√ß√£o do plugin e a estrutura criada, √© hora de por a m√£o na massa. A primeira coisa que precisamos fazer √© definir a implementa√ß√£o comum entre as plataformas, sabemos que iremos ter uma propriedade <strong>name</strong> que servir√° tanto para Android como para iOS, esta defini√ß√£o √© feita no arquivo common que foi gerado na primeira etapa deste artigo.</p>
<p><strong>emoji.common.ts</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">import &#123; View, Property &#125; from &quot;ui/core/view&quot;;</div><div class="line"></div><div class="line">export class EmojiCommon extends View &#123;</div><div class="line">  name: string;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export const nameProperty = new Property&lt;EmojiCommon, string&gt;(</div><div class="line">  &#123;</div><div class="line">    name: &quot;name&quot;,</div><div class="line">    defaultValue: &quot;&quot;</div><div class="line">  &#125;);</div><div class="line">nameProperty.register(EmojiCommon);</div></pre></td></tr></table></figure></p>
<p>Como se trata de um plugin para interface, precisamos extender a classe <strong>View</strong>. Os atributos do elemento que iremos criar, definimos criando um novo objeto do tipo <strong>Property</strong>, a propriedade <strong>name</strong> definimos o nome do atributo e o valor padr√£o, como o pr√≥prio nome sugere, definimos na propriedade <strong>defaultValue</strong>. Se o valor deste atributo fosse diferente do tipo <strong>string</strong>, que n√£o √© o nosso caso, seria necess√°rio definir o valor para a propriedade <strong>valueConverter</strong>.</p>
<p>A codifica√ß√£o dos emojis s√£o distintas para cada plataforma, por tanto precisamos ter uma base de dados para armazenar esses valores para consultarmos durante a execu√ß√£o do plugin.</p>
<p><strong>emoji.database.ts</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">export class EmojiDatabase &#123;</div><div class="line">    public static list(): Array&lt;any&gt; &#123;</div><div class="line">      return [</div><div class="line">    &#123;</div><div class="line">        &quot;name&quot;: &quot;FACE WITH TEARS OF JOY&quot;,</div><div class="line">        &quot;unicode&quot;: &quot;üòÇ&quot;,</div><div class="line">        &quot;hexcode&quot;: &quot;1F602&quot;,</div><div class="line">        &quot;codepoint&quot;: [</div><div class="line">            128514</div><div class="line">        ],</div><div class="line">        &quot;shortname&quot;: &quot;joy&quot;</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Implementacao-para-Android"><a href="#Implementacao-para-Android" class="headerlink" title="Implementa√ß√£o para Android"></a>Implementa√ß√£o para Android</h3><p>Agora que ja temos os atributos do elemento que iremos criar, precisamos implementar o codigo respons√°vel por gerar o elemento correspondente a cada plataforma. O NativeScript interpretar√° em tempo de execu√ß√£o o codigo espec√≠fico para Android atrav√©z do seguinte arquivo.</p>
<p><strong>emoji.android.ts</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">import &#123; nameProperty, EmojiCommon &#125; from &quot;./emoji.common&quot;;</div><div class="line">import &#123; EmojiDatabase &#125; from &quot;./emoji.database&quot;;</div><div class="line">import * as utils from &quot;tns-core-modules/utils/utils&quot;;</div><div class="line">declare var java: any;</div><div class="line"></div><div class="line">global.moduleMerge(EmojiCommon, exports);</div><div class="line"></div><div class="line">export class Emoji extends EmojiCommon &#123;</div><div class="line">  [nameProperty.getDefault](): string &#123;</div><div class="line">    return &apos;&apos;;</div><div class="line">  &#125;</div><div class="line">  [nameProperty.setNative](value: string) &#123;</div><div class="line">    let emoji = EmojiDatabase.list().find((el) =&gt; el.shortname ##= value).codepoint[0];</div><div class="line">    this.nativeView.setText(new java.lang.String(java.lang.Character.toChars(emoji)));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  private _android: android.widget.TextView;</div><div class="line"></div><div class="line">  get android() &#123;</div><div class="line">    return this.nativeView;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  public createNativeView() &#123;</div><div class="line">    this._android = new android.widget.TextView(utils.ad.getApplicationContext());</div><div class="line">    return this._android;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>O primeiro passo √© extender a classe common criada anteriormente. Por se tratar de um plugin para interface, √© necess√°rio implementarmos o m√©todo <strong>createNativeView</strong>, que far√° com que o o NativeScript entenda que algum elemento tem de ser criado na View. No nosso caso criaremos um <a href="https://developer.android.com/reference/android/widget/TextView.html" target="_blank" rel="external">TextView</a>. </p>
<p>E novamente aqui temos outra grande ajuda do framework, a equipe do NativeScript mapeou todas as propriedades e m√©todos nativos de cada plataforma e gerou as defini√ß√µes em TypeScript, o que nos da a possibilidade de navegar por todas estas defini√ß√µes nativas diretamente no editor.</p>
<p>Temos que definir tamb√©m o que o plugin far√° quando receber o atributo <strong>name</strong>, isso √© definido implementando o m√©todo <em>setNative</em>, que no nosso caso ir√° consultar o nome do emoji na base de dados, e com base no codigo correspondente, definira o valor para o TextView criado anteriormente. O metodo <em>getDefault</em> √© para casos em que nenhum valor seja definido.</p>
<h3 id="Implementacao-para-iOS"><a href="#Implementacao-para-iOS" class="headerlink" title="Implementa√ß√£o para iOS"></a>Implementa√ß√£o para iOS</h3><p>Podemos copiar a mesma implementa√ß√£o feita para o Android, e alterar somente as partes onde √© criado e definido o valor para o elemento nativo, que no caso do iOS ser√°  o <a href="https://developer.apple.com/reference/uikit/uilabel" target="_blank" rel="external">UILabel</a> ficando da seguinte maneira.</p>
<p><strong>emoji.ios.ts</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">import &#123; nameProperty, EmojiCommon &#125; from &quot;./emoji.common&quot;;</div><div class="line">import &#123; EmojiDatabase &#125; from &quot;./emoji.database&quot;;</div><div class="line"></div><div class="line">global.moduleMerge(EmojiCommon, exports);</div><div class="line"></div><div class="line">export class Emoji extends EmojiCommon &#123;</div><div class="line">  [nameProperty.getDefault](): number &#123;</div><div class="line">    return 0;</div><div class="line">  &#125;</div><div class="line">  [nameProperty.setNative](value: string) &#123;</div><div class="line">    let emoji = EmojiDatabase.list().find((el) =&gt; el.shortname ##= value).unicode;</div><div class="line">    let nsString = NSString.stringWithString(emoji);</div><div class="line">    this.nativeView.text = nsString;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  private _ios: UILabel;</div><div class="line"></div><div class="line">  get ios() &#123;</div><div class="line">    return this.nativeView;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  public createNativeView() &#123;</div><div class="line">    this._ios = UILabel.alloc().init();</div><div class="line">    return this._ios;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Novamente aqui ser√° possivel acessar a defini√ß√£o dos metodos nativos para iOS, no metodo <em>createNativeView</em> √© criado um UILabel e no m√©todo <em>setNative</em> √© definido o valor para o elemento criado.</p>
<h2 id="Testando-o-plugin"><a href="#Testando-o-plugin" class="headerlink" title="Testando o plugin"></a>Testando o plugin</h2><p>Sim, terminamos a implementa√ß√£o do plugin e o que resta agora √© apenas testarmos. Rapido n√£o? Para testarmos precisamos adicionar o plugin ao projeto <em>demo</em> criado nas etapas iniciais deste artigo. Para isso, √© necess√°rio executar o comando:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm run preparedemo</div></pre></td></tr></table></figure>
<p>Adicionar a referencia do elemento no elemento <em>Page</em> do arquivo <em>main-page.xml</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xmlns:Emoji=&quot;nativescript-emoji&quot;</div></pre></td></tr></table></figure>
<p>e ent√£o adicionar o elemento no dentro do <em>StackLayout</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Emoji:Emoji name=&quot;joy&quot; /&gt;</div></pre></td></tr></table></figure>
<p>Ficando da seguinte maneira.</p>
<p><em>main-page.xml</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;Page xmlns=&quot;http://schemas.nativescript.org/tns.xsd&quot; xmlns:Emoji=&quot;nativescript-emoji&quot; navigatingTo=&quot;navigatingTo&quot; class=&quot;page&quot;&gt;</div><div class="line">  </div><div class="line">    &lt;Page.actionBar&gt;</div><div class="line">        &lt;ActionBar title=&quot;NativeScript Emoji&quot; icon=&quot;&quot; class=&quot;action-bar&quot;&gt;</div><div class="line">        &lt;/ActionBar&gt;</div><div class="line">    &lt;/Page.actionBar&gt;</div><div class="line">    &lt;StackLayout orientation=&quot;horizontal&quot;&gt;</div><div class="line">        &lt;Label text=&quot;I&apos;m happy &quot;&gt; &lt;/Label&gt;</div><div class="line">        &lt;Emoji:Emoji name=&quot;joy&quot; /&gt;</div><div class="line">        &lt;Emoji:Emoji name=&quot;joy&quot; /&gt;</div><div class="line">        &lt;Emoji:Emoji name=&quot;joy&quot; /&gt;</div><div class="line">    &lt;/StackLayout&gt;</div><div class="line">&lt;/Page&gt;</div></pre></td></tr></table></figure></p>
<p>Agora resta executar o projeto de demonstra√ß√£o nos emuladores de cada plataforma executando os seguintes comandos.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nmm run demo.ios</div><div class="line">npm run demo.android</div></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/dzfweb/nativescript-emoji/master/emojiprintscreen.png" alt="NativeScript Emoji Plugin - Resultado final"></p>
<h2 id="Conclusao"><a href="#Conclusao" class="headerlink" title="Conclus√£o"></a>Conclus√£o</h2><p>Podemos ver como √© facil e rapido desenvolver um plugin para NativeScript, destaco alguns pontos como a comunidade de desenvolvedores NativeScript que s√£o bem participativos, a equipe da Telerik que a procura entregar a cada vers√£o ferramentas que vis√£o tornar nosso trabalho como desenvolvedor muito mais produtivo e lan√ßo o convite para voc√™ desenvolvedor que est√° lendo este artigo. Voc√™ desenvolveu algo customizado em algum projeto? Tem alguma ideia sobre alguma ferramenta que possa ser util? Contribua conosco tamb√©m.</p>
</div></div><div class="post-main post-comment"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'dzfweb';
var disqus_identifier = '25/05/2017/quao-facil-e-criar-um-plugin-para-nativescript/';
var disqus_title = 'Qu√£o facil √© criar um plugin para NativeScript';
var disqus_url = 'http://www.dzfweb.com.br/25/05/2017/quao-facil-e-criar-um-plugin-para-nativescript/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>